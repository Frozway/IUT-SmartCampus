<div class="panel shadow">
    <div class="mt-1">
        <h2>Toutes les données</h2>
        <table class="table table-stripe">
            <thead class="thead-dark">
            <tr>
                <th>Date de Capture</th>
                <th>Température (°C)</th>
                <th>CO2 (ppm)</th>
                <th>Humidité (%)</th>
            </tr>
            </thead>
            <tbody>
            {% set dataByDate = {} %}
            {% for value in data %}
                {% set currentDate = value.dateCapture|date('Y-m-d H:i:s') %}
                {% if attribute(dataByDate, currentDate) is not defined %}
                    {% set dataByDate = dataByDate|merge({(currentDate): {'temperature': null, 'co2': null, 'humidity': null, (value.nom): value.valeur}}) %}
                {% else %}
                    {% set currentData = attribute(dataByDate, currentDate) %}
                    {% set currentData = currentData|merge({(value.nom): value.valeur}) %}
                    {% set dataByDate = dataByDate|merge({(currentDate): currentData}) %}
                {% endif %}
            {% endfor %}



            {% for currentDate, values in dataByDate %}
                <tr>
                    <td>{{ currentDate }}</td>
                    <td>{{ values['temperature'] is not null ? values['temperature'] ~ ' °C' : 'N/A' }}</td>
                    <td>{{ values['co2'] is not null ? values['co2'] ~ ' ppm' : 'N/A' }}</td>
                    <td>{{ values['humidity'] is not null ? values['humidity'] ~ ' %' : 'N/A' }}</td>
                </tr>
            {% else %}
                <tr>
                    <td colspan="4">Aucune donnée disponible.</td>
                </tr>
            {% endfor %}
            </tbody>
        </table>
    </div>
</div>
